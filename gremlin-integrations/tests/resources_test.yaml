suite: "Gremlin Resources Tests"
templates:
  - "templates/deployment.yaml"

tests:
  - it: "should render resources when gremlin.resources is set"
    set:
      gremlin.resources.limits.cpu: "200m"
      gremlin.resources.limits.memory: "256Mi"
      gremlin.resources.requests.cpu: "100m"
      gremlin.resources.requests.memory: "128Mi"
    asserts:
      - equal:
          path: "spec.template.spec.containers[0].resources.limits.cpu"
          value: "200m"
      - equal:
          path: "spec.template.spec.containers[0].resources.limits.memory"
          value: "256Mi"
      - equal:
          path: "spec.template.spec.containers[0].resources.requests.cpu"
          value: "100m"
      - equal:
          path: "spec.template.spec.containers[0].resources.requests.memory"
          value: "128Mi"

  - it: "should set resources to empty map when gremlin.resources is empty"
    set:
      gremlin.resources: {}
    asserts:
      - equal:
          path: "spec.template.spec.containers[0].resources"
          value: {}

